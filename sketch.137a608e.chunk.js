"use strict";(self.webpackChunk_genially_view_client=self.webpackChunk_genially_view_client||[]).push([[8747],{56063:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var r=n(14726),o=n(84398),i=n(17588);function l(){const{viewStore:e}=(0,o.g)(),t=function(){const[e,t]=(0,i.useState)({top:0,left:0}),{viewStore:n}=(0,o.g)(),{scrollElement:r}=n;return(0,i.useEffect)((()=>{if(!r)return;const e=()=>{var e,n;t({left:null!==(e=null===r||void 0===r?void 0:r.scrollLeft)&&void 0!==e?e:0,top:null!==(n=null===r||void 0===r?void 0:r.scrollTop)&&void 0!==n?n:0})};return e(),r.addEventListener("scroll",e),()=>{r.removeEventListener("scroll",e)}}),[r]),e}(),{zoomLevel:n}=e;return(0,i.useCallback)((e=>({x:(e.x-window.scrollX+t.left)/n,y:(e.y-window.scrollY+t.top)/n})),[t,n])}var s=n(37577);const u=s.Ay.div({position:"absolute",borderRadius:"50%",zIndex:3,pointerEvents:"none",touchAction:"none",opacity:.75});var c=n(45992);const a=(0,r.PA)((()=>{const e=(()=>{const[e,t]=(0,i.useState)();return(0,i.useEffect)((()=>{const e=e=>{t({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e,{capture:!0}),()=>{window.removeEventListener("mousemove",e,{capture:!0})}}),[]),e})(),t=l()(null!==e&&void 0!==e?e:{x:0,y:0}),{paintStore:n,viewStore:r}=(0,o.g)(),s=r.topmostSlide,a=r.calculateSlideScaleToFit(s),{selectedColor:h,widthSelected:p}=n,d=p*a;return(0,c.jsx)(u,{style:{width:d,height:d,backgroundColor:h,left:t.x-d/2,top:t.y-d/2}})}));function h(e,t,n){return e*(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>e)(.5-t*(.5-n))}function p(e,t){return[e[0]+t[0],e[1]+t[1]]}function d(e,t){return[e[0]-t[0],e[1]-t[1]]}function g(e,t){return[e[0]*t,e[1]*t]}function f(e){return[e[1],-e[0]]}function v(e,t){return e[0]*t[0]+e[1]*t[1]}function w(e,t){return e[0]===t[0]&&e[1]===t[1]}function m(e,t){return function(e){return e[0]*e[0]+e[1]*e[1]}(d(e,t))}function x(e){return function(e,t){return[e[0]/t,e[1]/t]}(e,function(e){return Math.hypot(e[0],e[1])}(e))}function y(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function L(e,t,n){let r=Math.sin(n),o=Math.cos(n),i=e[0]-t[0],l=e[1]-t[1],s=i*r+l*o;return[i*o-l*r+t[0],s+t[1]]}function C(e,t,n){return p(e,g(d(t,e),n))}function S(e,t,n){return p(e,g(t,n))}var{min:M,PI:b}=Math,P=b+1e-4;function $(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{size:n=16,smoothing:r=.5,thinning:o=.5,simulatePressure:i=!0,easing:l=e=>e,start:s={},end:u={},last:c=!1}=t,{cap:a=!0,easing:w=e=>e*(2-e)}=s,{cap:y=!0,easing:b=e=>--e*e*e+1}=u;if(0===e.length||n<=0)return[];let $,k=e[e.length-1].runningLength,A=!1===s.taper?0:!0===s.taper?Math.max(n,k):s.taper,z=!1===u.taper?0:!0===u.taper?Math.max(n,k):u.taper,E=Math.pow(n*r,2),j=[],_=[],I=e.slice(0,10).reduce(((e,t)=>{let r=t.pressure;if(i){let o=M(1,t.distance/n),i=M(1,1-o);r=M(1,e+.275*o*(i-e))}return(e+r)/2}),e[0].pressure),Z=h(n,o,e[e.length-1].pressure,l),T=e[0].vector,X=e[0].point,Y=X,B=X,D=Y,F=!1;for(let x=0;x<e.length;x++){let{pressure:t}=e[x],{point:r,vector:s,distance:u,runningLength:c}=e[x];if(x<e.length-1&&k-c<3)continue;if(o){if(i){let e=M(1,u/n),r=M(1,1-e);t=M(1,I+.275*e*(r-I))}Z=h(n,o,t,l)}else Z=n/2;void 0===$&&($=Z);let a=c<A?w(c/A):1,y=k-c<z?b((k-c)/z):1;Z=Math.max(.01,Z*Math.min(a,y));let S=(x<e.length-1?e[x+1]:e[x]).vector,H=x<e.length-1?v(s,S):1,R=null!==H&&H<0;if(v(s,T)<0&&!F||R){let e=g(f(T),Z);for(let t=1/13,n=0;n<=1;n+=t)B=L(d(r,e),r,P*n),j.push(B),D=L(p(r,e),r,P*-n),_.push(D);X=B,Y=D,R&&(F=!0);continue}if(F=!1,x===e.length-1){let e=g(f(s),Z);j.push(d(r,e)),_.push(p(r,e));continue}let W=g(f(C(S,s,H)),Z);B=d(r,W),(x<=1||m(X,B)>E)&&(j.push(B),X=B),D=p(r,W),(x<=1||m(Y,D)>E)&&(_.push(D),Y=D),I=t,T=s}let H=e[0].point.slice(0,2),R=e.length>1?e[e.length-1].point.slice(0,2):p(e[0].point,[1,1]),W=[],N=[];if(1===e.length){if(!A&&!z||c){let e=S(H,x(f(d(H,R))),-($||Z)),t=[];for(let n=1/13,r=n;r<=1;r+=n)t.push(L(e,H,2*P*r));return t}}else{if(!(A||z&&1===e.length))if(a)for(let e=1/13,n=e;n<=1;n+=e){let e=L(_[0],H,P*n);W.push(e)}else{let e=d(j[0],_[0]),t=g(e,.5),n=g(e,.51);W.push(d(H,t),d(H,n),p(H,n),p(H,t))}let t=f(function(e){return[-e[0],-e[1]]}(e[e.length-1].vector));if(z||A&&1===e.length)N.push(R);else if(y){let e=S(R,t,Z);for(let t=1/29,n=t;n<1;n+=t)N.push(L(e,R,3*P*n))}else N.push(p(R,g(t,Z)),p(R,g(t,.99*Z)),d(R,g(t,.99*Z)),d(R,g(t,Z)))}return j.concat(N,_.reverse(),W)}(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;let{streamline:r=.5,size:o=16,last:i=!1}=t;if(0===e.length)return[];let l=.15+.85*(1-r),s=Array.isArray(e[0])?e:e.map((e=>{let{x:t,y:n,pressure:r=.5}=e;return[t,n,r]}));if(2===s.length){let e=s[1];s=s.slice(0,-1);for(let t=1;t<5;t++)s.push(C(s[0],e,t/4))}1===s.length&&(s=[...s,[...p(s[0],[1,1]),...s[0].slice(2)]]);let u=[{point:[s[0][0],s[0][1]],pressure:s[0][2]>=0?s[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,a=0,h=u[0],g=s.length-1;for(let p=1;p<s.length;p++){let e=i&&p===g?s[p].slice(0,2):C(h.point,s[p],l);if(w(h.point,e))continue;let t=y(e,h.point);if(a+=t,p<g&&!c){if(a<o)continue;c=!0}h={point:e,pressure:s[p][2]>=0?s[p][2]:.5,vector:x(d(h.point,e)),distance:t,runningLength:a},u.push(h)}return u[0].vector=(null==(n=u[1])?void 0:n.vector)||[0,0],u}(e,t),t)}const k={size:16,smoothing:1,thinning:.5,streamline:0,easing:e=>e,start:{taper:0,cap:!0},end:{taper:0,cap:!0}};const A=(0,r.PA)((e=>{let{path:t}=e;const n=function(e){if(!e.length)return"";let t=`M ${e[0][0]} ${e[0][1]} Q`;for(let n=0;n<e.length;n+=1){const[r,o]=e[n],[i,l]=e[(n+1)%e.length];t+=` ${r} ${o} ${(r+i)/2} ${(o+l)/2}`}return t+"Z"}($(t.points,{...k,size:t.size}));return(0,c.jsx)("path",{d:n,fill:t.color})}));const z=function(e){return`data:image/svg+xml;base64,${window.btoa(e)}`}('\n    <svg width="24" height="24" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">\n        <g style="filter: drop-shadow(0px 1px 4px rgba(0, 15, 51, 0.20)););">\n            <path d="M46.2844 5.22217C46.0912 5.22048 45.9066 5.29562 45.7712 5.43105L10.614 40.5882C9.07684 42.1254 8.03639 44.0885 7.62735 46.2236L5.22214 58.778L17.7765 56.3728C19.9116 55.9638 21.8748 54.9233 23.412 53.3861L58.5691 18.229C58.7045 18.0936 58.7797 17.9089 58.778 17.7157C58.7181 10.8756 53.1246 5.28204 46.2844 5.22217Z" fill="white"/>\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M60.1353 17.7037C60.0689 10.1232 53.8768 3.93105 46.2963 3.8647C45.7426 3.85986 45.2067 4.07564 44.8112 4.47111L9.65412 39.6282C7.92477 41.3576 6.75427 43.5661 6.2941 45.9681L3.88889 58.5225C3.80423 58.9644 3.94405 59.4196 4.26222 59.7378C4.5804 60.0559 5.03556 60.1958 5.47749 60.1111L18.0319 57.7059C20.4338 57.2457 22.6424 56.0752 24.3718 54.3459L59.5289 19.1888C59.9244 18.7933 60.1401 18.2574 60.1353 17.7037ZM40.8692 12.2525L46.5369 6.58488C52.428 6.77495 57.225 11.572 57.4151 17.4631L51.7475 23.1308L40.8692 12.2525ZM38.9495 14.1722L11.5738 41.5479C10.2288 42.893 9.31838 44.6107 8.96046 46.4789L6.93173 57.0683L17.521 55.0395C19.3893 54.6816 21.107 53.7712 22.4521 52.4262L49.8278 25.0505L38.9495 14.1722Z" fill="black"/>\n        </g>\n    </svg>\n'),E=s.Ay.svg((()=>({zIndex:2,opacity:.75,touchAction:"none"}))),j=(0,r.PA)((()=>{var e;const t=(0,o.g)(),[n,r]=(0,i.useState)(!1),{viewStore:s}=t,u=t.paintStore,{sketchStorage:h,selectedColor:p,widthSelected:d}=u,g=s.topmostSlide,f=s.calculateSlideScaleToFit(g),v=s.domNode.getBoundingClientRect(),w=(v.width-g.Width*f)/2+v.x,m=(v.height-g.Height*f)/2+v.y,x=l(),y=e=>{const t=x(e);return{x:(t.x-w)/f,y:(t.y-m)/f,pressure:e.pressure}},L=(0,i.useRef)(void 0);return(0,c.jsxs)(i.Fragment,{children:[n&&(0,c.jsx)(a,{}),(0,c.jsx)(E,{"data-genially-role":"sketch-svg",role:"img",onPointerDownCapture:e=>{if(1!==e.buttons)return;e.preventDefault(),e.stopPropagation();const t=u.startPath(g.Id);t.setColor(p),t.setSize(d),t.addPoint(y({x:e.pageX,y:e.pageY,pressure:e.pressure})),L.current=t},onPointerMoveCapture:e=>{var t;1===e.buttons&&(e.preventDefault(),e.stopPropagation(),null===(t=L.current)||void 0===t||t.addPoint(y({x:e.pageX,y:e.pageY,pressure:e.pressure})))},onMouseEnter:()=>{document.body.style.cursor=`url(${z}) 1 23, auto`,r(!0)},onMouseLeave:()=>{document.body.style.cursor="auto",r(!1)},style:{width:g.Width*f,height:g.Height*f},viewBox:`0 0 ${g.Width} ${g.Height}`,children:null===(e=h.get(g.Id))||void 0===e?void 0:e.map(((e,t)=>(0,c.jsx)(A,{path:e},`path-${t.toString()}`)))})]})})),_=(0,r.PA)((()=>{const{viewStore:e}=(0,o.g)();return(0,c.jsx)("div",{className:"genially-view-sketch-field-container",children:!e.slideTransitioning&&(0,c.jsx)(j,{})})}))}}]);
//# sourceMappingURL=https://s3-static-genially.genially.com/view/static/js/sketch.137a608e.chunk.js.map